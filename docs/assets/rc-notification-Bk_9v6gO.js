import{c as w,d as ge,g as ee,b as ue,k as Ne,e as z,f as J}from"./@babel-C_SyoEfJ.js";import{r as o,a as V}from"./react-BwYbncKq.js";import{r as Re}from"./react-dom-CYoFxZK3.js";import{c as Q}from"./classnames-C6I1OsXt.js";import{a as pe}from"./rc-motion-fdt2-AWL.js";import{B as Ae,K as Le,j as Pe}from"./rc-util-qpEr0zEL.js";var _e=o.forwardRef(function(e,r){var d=e.prefixCls,c=e.style,l=e.className,N=e.duration,C=N===void 0?4.5:N,p=e.showProgress,_=e.pauseOnHover,A=_===void 0?!0:_,j=e.eventKey,D=e.content,m=e.closable,g=e.closeIcon,b=g===void 0?"x":g,y=e.props,f=e.onClick,F=e.onNoticeClose,H=e.times,E=e.hovering,S=o.useState(!1),x=w(S,2),u=x[0],O=x[1],a=o.useState(0),t=w(a,2),n=t[0],i=t[1],R=o.useState(0),L=w(R,2),k=L[0],U=L[1],v=E||u,P=C>0&&p,T=function(){F(j)},q=function(s){(s.key==="Enter"||s.code==="Enter"||s.keyCode===Le.ENTER)&&T()};o.useEffect(function(){if(!v&&C>0){var M=Date.now()-k,s=setTimeout(function(){T()},C*1e3-k);return function(){A&&clearTimeout(s),U(Date.now()-M)}}},[C,v,H]),o.useEffect(function(){if(!v&&P&&(A||k===0)){var M=performance.now(),s,h=function ne(){cancelAnimationFrame(s),s=requestAnimationFrame(function(oe){var G=oe+k-M,K=Math.min(G/(C*1e3),1);i(K*100),K<1&&ne()})};return h(),function(){A&&cancelAnimationFrame(s)}}},[C,k,v,P,H]);var X=o.useMemo(function(){return ge(m)==="object"&&m!==null?m:m?{closeIcon:b}:{}},[m,b]),te=Ae(X,!0),B=100-(!n||n<0?0:n>100?100:n),I="".concat(d,"-notice");return o.createElement("div",ee({},y,{ref:r,className:Q(I,l,ue({},"".concat(I,"-closable"),m)),style:c,onMouseEnter:function(s){var h;O(!0),y==null||(h=y.onMouseEnter)===null||h===void 0||h.call(y,s)},onMouseLeave:function(s){var h;O(!1),y==null||(h=y.onMouseLeave)===null||h===void 0||h.call(y,s)},onClick:f}),o.createElement("div",{className:"".concat(I,"-content")},D),m&&o.createElement("a",ee({tabIndex:0,className:"".concat(I,"-close"),onKeyDown:q,"aria-label":"Close"},te,{onClick:function(s){s.preventDefault(),s.stopPropagation(),T()}}),X.closeIcon),P&&o.createElement("progress",{className:"".concat(I,"-progress"),max:"100",value:B},B+"%"))}),he=V.createContext({}),Ue=function(r){var d=r.children,c=r.classNames;return V.createElement(he.Provider,{value:{classNames:c}},d)},de=8,me=3,ye=16,be=function(r){var d={offset:de,threshold:me,gap:ye};if(r&&ge(r)==="object"){var c,l,N;d.offset=(c=r.offset)!==null&&c!==void 0?c:de,d.threshold=(l=r.threshold)!==null&&l!==void 0?l:me,d.gap=(N=r.gap)!==null&&N!==void 0?N:ye}return[!!r,d]},Me=["className","style","classNames","styles"],we=function(r){var d=r.configList,c=r.placement,l=r.prefixCls,N=r.className,C=r.style,p=r.motion,_=r.onAllNoticeRemoved,A=r.onNoticeClose,j=r.stack,D=o.useContext(he),m=D.classNames,g=o.useRef({}),b=o.useState(null),y=w(b,2),f=y[0],F=y[1],H=o.useState([]),E=w(H,2),S=E[0],x=E[1],u=d.map(function(v){return{config:v,key:String(v.key)}}),O=be(j),a=w(O,2),t=a[0],n=a[1],i=n.offset,R=n.threshold,L=n.gap,k=t&&(S.length>0||u.length<=R),U=typeof p=="function"?p(c):p;return o.useEffect(function(){t&&S.length>1&&x(function(v){return v.filter(function(P){return u.some(function(T){var q=T.key;return P===q})})})},[S,u,t]),o.useEffect(function(){var v;if(t&&g.current[(v=u[u.length-1])===null||v===void 0?void 0:v.key]){var P;F(g.current[(P=u[u.length-1])===null||P===void 0?void 0:P.key])}},[u,t]),V.createElement(pe,ee({key:c,className:Q(l,"".concat(l,"-").concat(c),m==null?void 0:m.list,N,ue(ue({},"".concat(l,"-stack"),!!t),"".concat(l,"-stack-expanded"),k)),style:C,keys:u,motionAppear:!0},U,{onAllRemoved:function(){_(c)}}),function(v,P){var T=v.config,q=v.className,X=v.style,te=v.index,B=T,I=B.key,M=B.times,s=String(I),h=T,ne=h.className,oe=h.style,G=h.classNames,K=h.styles,Se=Ne(h,Me),ae=u.findIndex(function(Z){return Z.key===s}),Y={};if(t){var $=u.length-1-(ae>-1?ae:te-1),fe=c==="top"||c==="bottom"?"-50%":"0";if($>0){var re,ie,se;Y.height=k?(re=g.current[s])===null||re===void 0?void 0:re.offsetHeight:f==null?void 0:f.offsetHeight;for(var ve=0,ce=0;ce<$;ce++){var le;ve+=((le=g.current[u[u.length-1-ce].key])===null||le===void 0?void 0:le.offsetHeight)+L}var ke=(k?ve:$*i)*(c.startsWith("top")?1:-1),Ee=!k&&f!==null&&f!==void 0&&f.offsetWidth&&(ie=g.current[s])!==null&&ie!==void 0&&ie.offsetWidth?((f==null?void 0:f.offsetWidth)-i*2*($<3?$:3))/((se=g.current[s])===null||se===void 0?void 0:se.offsetWidth):1;Y.transform="translate3d(".concat(fe,", ").concat(ke,"px, 0) scaleX(").concat(Ee,")")}else Y.transform="translate3d(".concat(fe,", 0, 0)")}return V.createElement("div",{ref:P,className:Q("".concat(l,"-notice-wrapper"),q,G==null?void 0:G.wrapper),style:z(z(z({},X),Y),K==null?void 0:K.wrapper),onMouseEnter:function(){return x(function(W){return W.includes(s)?W:[].concat(J(W),[s])})},onMouseLeave:function(){return x(function(W){return W.filter(function(xe){return xe!==s})})}},V.createElement(_e,ee({},Se,{ref:function(W){ae>-1?g.current[s]=W:delete g.current[s]},prefixCls:l,classNames:G,styles:K,className:Q(ne,m==null?void 0:m.notice),style:oe,times:M,key:I,eventKey:I,onNoticeClose:A,hovering:t&&S.length>0})))})},He=o.forwardRef(function(e,r){var d=e.prefixCls,c=d===void 0?"rc-notification":d,l=e.container,N=e.motion,C=e.maxCount,p=e.className,_=e.style,A=e.onAllRemoved,j=e.stack,D=e.renderNotifications,m=o.useState([]),g=w(m,2),b=g[0],y=g[1],f=function(t){var n,i=b.find(function(R){return R.key===t});i==null||(n=i.onClose)===null||n===void 0||n.call(i),y(function(R){return R.filter(function(L){return L.key!==t})})};o.useImperativeHandle(r,function(){return{open:function(t){y(function(n){var i=J(n),R=i.findIndex(function(U){return U.key===t.key}),L=z({},t);if(R>=0){var k;L.times=(((k=n[R])===null||k===void 0?void 0:k.times)||0)+1,i[R]=L}else L.times=0,i.push(L);return C>0&&i.length>C&&(i=i.slice(-C)),i})},close:function(t){f(t)},destroy:function(){y([])}}});var F=o.useState({}),H=w(F,2),E=H[0],S=H[1];o.useEffect(function(){var a={};b.forEach(function(t){var n=t.placement,i=n===void 0?"topRight":n;i&&(a[i]=a[i]||[],a[i].push(t))}),Object.keys(E).forEach(function(t){a[t]=a[t]||[]}),S(a)},[b]);var x=function(t){S(function(n){var i=z({},n),R=i[t]||[];return R.length||delete i[t],i})},u=o.useRef(!1);if(o.useEffect(function(){Object.keys(E).length>0?u.current=!0:u.current&&(A==null||A(),u.current=!1)},[E]),!l)return null;var O=Object.keys(E);return Re.createPortal(o.createElement(o.Fragment,null,O.map(function(a){var t=E[a],n=o.createElement(we,{key:a,configList:t,placement:a,prefixCls:c,className:p==null?void 0:p(a),style:_==null?void 0:_(a),motion:N,onNoticeClose:f,onAllNoticeRemoved:x,stack:j});return D?D(n,{prefixCls:c,key:a}):n})),l)}),Ie=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved","stack","renderNotifications"],De=function(){return document.body},Ce=0;function Oe(){for(var e={},r=arguments.length,d=new Array(r),c=0;c<r;c++)d[c]=arguments[c];return d.forEach(function(l){l&&Object.keys(l).forEach(function(N){var C=l[N];C!==void 0&&(e[N]=C)})}),e}function qe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.getContainer,d=r===void 0?De:r,c=e.motion,l=e.prefixCls,N=e.maxCount,C=e.className,p=e.style,_=e.onAllRemoved,A=e.stack,j=e.renderNotifications,D=Ne(e,Ie),m=o.useState(),g=w(m,2),b=g[0],y=g[1],f=o.useRef(),F=o.createElement(He,{container:b,ref:f,prefixCls:l,motion:c,maxCount:N,className:C,style:p,onAllRemoved:_,stack:A,renderNotifications:j}),H=o.useState([]),E=w(H,2),S=E[0],x=E[1],u=Pe(function(a){var t=Oe(D,a);(t.key===null||t.key===void 0)&&(t.key="rc-notification-".concat(Ce),Ce+=1),x(function(n){return[].concat(J(n),[{type:"open",config:t}])})}),O=o.useMemo(function(){return{open:u,close:function(t){x(function(n){return[].concat(J(n),[{type:"close",key:t}])})},destroy:function(){x(function(t){return[].concat(J(t),[{type:"destroy"}])})}}},[]);return o.useEffect(function(){y(d())}),o.useEffect(function(){if(f.current&&S.length){S.forEach(function(n){switch(n.type){case"open":f.current.open(n.config);break;case"close":f.current.close(n.key);break;case"destroy":f.current.destroy();break}});var a,t;x(function(n){return(a!==n||!t)&&(a=n,t=n.filter(function(i){return!S.includes(i)})),t})}},[S]),[O,F]}export{_e as N,Ue as a,qe as u};
