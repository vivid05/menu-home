var H=Object.defineProperty;var K=(t,o,i)=>o in t?H(t,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[o]=i;var T=(t,o,i)=>K(t,typeof o!="symbol"?o+"":o,i);import{r as h,j as e,a as Q}from"./react-BwYbncKq.js";import{c as U}from"./react-dom-CYoFxZK3.js";import{T as M,S as L,C as A,B as g,F as _,s as d,a as E,M as G,b as I,I as X,D as O,c as Z,z as ee}from"./antd-DQNjyfAT.js";import{D as te}from"./dexie-CHToNQ8G.js";import{u as V,a as P,B as re,R as se,b as J}from"./react-router-DIMhQKeV.js";import{t as ne,P as $,Q as Y,T as oe,U as W,V as ie}from"./@ant-design-BDIhShda.js";import{F as q}from"./@monaco-editor-BdY340vY.js";import"./@babel-C_SyoEfJ.js";import"./scheduler-DYLXRpC5.js";import"./rc-util-qpEr0zEL.js";import"./react-is-DcAOwtUU.js";import"./classnames-C6I1OsXt.js";import"./rc-resize-observer-Djs7foYh.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-motion-fdt2-AWL.js";import"./@rc-component-BhmwWRgm.js";import"./rc-overflow-BSjmwJ5L.js";import"./rc-tabs-DzBt95t3.js";import"./rc-dropdown-Cpbpbr8d.js";import"./rc-menu-odk1-mql.js";import"./rc-select-BYP2ZpD4.js";import"./rc-virtual-list-Bi_WoJXF.js";import"./rc-field-form-W94e64e7.js";import"./rc-dialog-BcW66EVf.js";import"./rc-notification-Bk_9v6gO.js";import"./rc-table-DDN2Jo9n.js";import"./rc-tree-BGBWsLK6.js";import"./rc-checkbox-gkqbq-se.js";import"./scroll-into-view-if-needed-Bq0bK-M8.js";import"./compute-scroll-into-view-Bl8rNFhg.js";import"./rc-pagination-Bvz_Ru-I.js";import"./throttle-debounce-CUWDS_la.js";import"./rc-input-DdsdxYUa.js";import"./rc-picker-ctJ4hI_D.js";import"./rc-tooltip-aJh4r6ka.js";import"./rc-textarea-7R1xcK0F.js";import"./copy-to-clipboard-DhLP-jDv.js";import"./toggle-selection-BHUZwh74.js";import"./@emotion-CW87jbl0.js";import"./stylis-D5iaQeiq.js";import"./state-local-BBNhjlcY.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const m of l.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function i(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=i(a);fetch(a.href,l)}})();class ae extends te{constructor(){super("MenuDatabase");T(this,"menuConfigs");this.version(1).stores({menuConfigs:"++id, version, name, createdAt, updatedAt"})}}const C=new ae,b={async getAll(){return C.menuConfigs.orderBy("createdAt").reverse().toArray()},async getById(t){return C.menuConfigs.get(Number(t))},async searchByVersion(t){return C.menuConfigs.where("version").startsWithIgnoreCase(t).reverse().sortBy("createdAt")},async add(t){const o=new Date;return C.menuConfigs.add({...t,createdAt:o,updatedAt:o})},async update(t,o){await C.menuConfigs.update(Number(t),{...o,updatedAt:new Date})},async delete(t){await C.menuConfigs.delete(Number(t))},async deleteByVersion(t){const i=(await this.searchByVersion(t)).map(n=>n.id);await C.menuConfigs.bulkDelete(i)},async exportAll(){return this.getAll()},async importConfigs(t){await C.menuConfigs.bulkAdd(t.map(o=>({...o,id:void 0})))}},{confirm:le}=G,{Title:ce}=M,{Option:de}=L,ue=()=>{const t=[{value:"",label:"å…¨éƒ¨ç‰ˆæœ¬"}],o=new Date().getFullYear();for(let i=1;i<=12;i++)for(let n=1;n<=2;n++){const a=`${o}-${i}æœˆ${n}æœŸ`,l=`${o}å¹´${i}æœˆ${n}æœŸ`;t.push({value:a,label:l})}return t},pe=()=>{const[t,o]=h.useState([]),[i,n]=h.useState([]),[a,l]=h.useState(!1),[m,w]=h.useState(""),S=V(),x=()=>{const r=new Date,p=r.getFullYear(),s=r.getMonth()+1;return`${p}-${s}æœˆ1æœŸ`};h.useEffect(()=>{(async()=>{await u();const p=x();w(p),f(p)})()},[]);const u=async()=>{l(!0);try{const r=await b.getAll();o(r),n(r)}catch{d.error("åŠ è½½èœå•é…ç½®å¤±è´¥")}finally{l(!1)}},f=async(r,p)=>{if(w(r),!r){n(t);return}try{const s=await b.searchByVersion(r);n(s)}catch{d.error("ç­›é€‰å¤±è´¥")}},R=async r=>{try{await navigator.clipboard.writeText(r),d.success("JSONé…ç½®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch{const s=document.createElement("textarea");s.value=r,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),d.success("JSONé…ç½®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}},B=async()=>{if(!m){d.warning("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªè¿­ä»£ç‰ˆæœ¬");return}try{const r=i.length>0?i:await b.searchByVersion(m),p=[];for(const c of r)try{const v=JSON.parse(c.jsonConfig),D=(y,k=c.path)=>{typeof y=="object"&&y!==null&&(y.resourceMultilingualList&&Array.isArray(y.resourceMultilingualList)&&y.resourcetype===1&&y.resourceMultilingualList.forEach(j=>{j&&typeof j=="object"&&j.name&&p.push(`${k}//${j.name}`),D(j,k)}),Object.keys(y).forEach(j=>{typeof y[j]=="object"&&y[j]!==null&&D(y[j],k)}))};D(v)}catch(v){console.error(`è§£æžé…ç½®ID ${c.id} çš„JSONæ—¶å‡ºé”™:`,v)}const s=p.join(`
`);await navigator.clipboard.writeText(s),d.success(`å·²å¤åˆ¶ ${p.length} æ¡è·¯å¾„åˆ°å‰ªè´´æ¿`)}catch(r){console.error("æ‰¹é‡å¤åˆ¶è·¯å¾„å¤±è´¥:",r),d.error("æ‰¹é‡å¤åˆ¶è·¯å¾„å¤±è´¥")}},N=r=>{le({title:"ç¡®è®¤åˆ é™¤",content:"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªèœå•é…ç½®å—ï¼Ÿ",okText:"åˆ é™¤",okType:"danger",cancelText:"å–æ¶ˆ",onOk:async()=>{try{await b.delete(r),d.success("åˆ é™¤æˆåŠŸ"),u()}catch{d.error("åˆ é™¤å¤±è´¥")}}})},z=[{title:"èœå•è·¯å¾„",dataIndex:"path",key:"path",width:250},{title:"è¿­ä»£ç‰ˆæœ¬å·",dataIndex:"version",key:"version",width:150},{title:"åˆ›å»ºæ—¶é—´",dataIndex:"createdAt",key:"createdAt",width:180,render:r=>new Date(r).toLocaleString()},{title:"æ›´æ–°æ—¶é—´",dataIndex:"updatedAt",key:"updatedAt",width:180,render:r=>new Date(r).toLocaleString()},{title:"æ“ä½œ",key:"action",width:240,render:(r,p)=>e.jsxs(E,{size:"small",children:[e.jsx(g,{size:"small",icon:e.jsx($,{}),onClick:()=>R(p.jsonConfig),children:"å¤åˆ¶JSON"}),e.jsx(g,{size:"small",icon:e.jsx(Y,{}),onClick:()=>S(`/edit/${p.id}`),children:"ç¼–è¾‘"}),e.jsx(g,{size:"small",danger:!0,icon:e.jsx(oe,{}),onClick:()=>N(p.id.toString()),children:"åˆ é™¤"})]})}];return e.jsxs("div",{style:{padding:"24px",background:"#f5f5f5",minHeight:"100vh"},children:[e.jsxs(A,{style:{marginBottom:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsx(ce,{level:2,style:{margin:0,color:"#1890ff"},children:"ðŸ“‹ èœå•é…ç½®ç®¡ç†ç³»ç»Ÿ"}),e.jsx(g,{type:"primary",size:"large",icon:e.jsx(ne,{}),onClick:()=>S("/add"),style:{borderRadius:"8px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.4)"},children:"æ–°å¢žèœå•"})]}),e.jsxs("div",{style:{marginBottom:"20px",display:"flex",gap:"16px"},children:[e.jsx(L,{placeholder:"ðŸ” è¯·é€‰æ‹©è¿­ä»£ç‰ˆæœ¬å·ç­›é€‰",allowClear:!0,size:"large",value:m,onChange:r=>f(r||""),style:{width:400},children:ue().map(r=>e.jsx(de,{value:r.value,children:r.label},r.value))}),e.jsx(g,{type:"primary",size:"large",icon:e.jsx($,{}),onClick:B,disabled:!m,style:{borderRadius:"8px"},children:"æ‰¹é‡å¤åˆ¶è·¯å¾„"})]})]}),e.jsx(A,{style:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:e.jsx(_,{columns:z,dataSource:i,rowKey:"id",loading:a,pagination:{total:i.length,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:r=>`å…± ${r} æ¡è®°å½•`,style:{marginTop:"16px"}},style:{borderRadius:"8px"}})})]})},{Title:me}=M,{Option:fe}=L,he=()=>{const t=[],o=new Date().getFullYear();for(let i=1;i<=12;i++)for(let n=1;n<=2;n++){const a=`${i}æœˆ${n}æœŸ`,l=`${o}å¹´${i}æœˆ${n}æœŸ`;t.push({value:`${o}-${a}`,label:l})}return t.sort((i,n)=>i.value.localeCompare(n.value))},F=()=>{const[t]=I.useForm(),[o,i]=h.useState(!1),[n,a]=h.useState(""),[l,m]=h.useState(""),[w,S]=h.useState(""),x=V(),{id:u}=P(),f=!!u;h.useEffect(()=>{f&&u?B(u):R()},[u,f]);const R=async()=>{try{const s=await b.getAll();if(s.length>0){const c=s[0];S(c.version),t.setFieldsValue({version:c.version})}}catch(s){console.error("èŽ·å–æœ€æ–°é…ç½®å¤±è´¥:",s)}},B=async s=>{i(!0);try{const c=await b.getById(s);c?(t.setFieldsValue({version:c.version,path:c.path}),a(c.jsonConfig)):(d.error("èœå•é…ç½®ä¸å­˜åœ¨"),x("/"))}catch{d.error("åŠ è½½èœå•é…ç½®å¤±è´¥"),x("/")}finally{i(!1)}},N=s=>{try{return JSON.parse(s),m(""),!0}catch{return m("JSONæ ¼å¼ä¸æ­£ç¡®"),!1}},z=s=>{const c=s||"";a(c),c.trim()?N(c):m("")},r=async s=>{if(!n.trim()){d.error("è¯·è¾“å…¥èœå•JSONé…ç½®");return}let c=n;if(c=n.replace(/hwsj/g,"touch"),!N(c)){d.error("JSONæ ¼å¼ä¸æ­£ç¡®ï¼Œè¯·æ£€æŸ¥åŽé‡è¯•");return}i(!0);try{f&&u?(await b.update(u,{...s,jsonConfig:c}),d.success("æ›´æ–°æˆåŠŸ")):(await b.add({...s,jsonConfig:c}),d.success("ä¿å­˜æˆåŠŸ")),x("/")}catch{d.error(f?"æ›´æ–°å¤±è´¥":"ä¿å­˜å¤±è´¥")}finally{i(!1)}},p=()=>{try{const s=JSON.parse(n),c=JSON.stringify(s,null,2);a(c),m(""),d.success("JSONæ ¼å¼åŒ–æˆåŠŸ")}catch{d.error("JSONæ ¼å¼ä¸æ­£ç¡®ï¼Œæ— æ³•æ ¼å¼åŒ–")}};return e.jsx("div",{style:{padding:"24px",background:"#f5f5f5",minHeight:"100vh"},children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[e.jsxs("div",{style:{marginBottom:"24px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(g,{icon:e.jsx(W,{}),onClick:()=>x("/"),style:{marginRight:"16px",borderRadius:"8px",border:"1px solid #d9d9d9"},children:"è¿”å›žåˆ—è¡¨"}),e.jsx(me,{level:2,style:{margin:0,color:"#1890ff"},children:f?"âœï¸ ç¼–è¾‘èœå•é…ç½®":"âž• æ–°å¢žèœå•é…ç½®"})]}),e.jsx(g,{type:"primary",onClick:t.submit,loading:o,icon:e.jsx(ie,{}),size:"large",disabled:!!l||!n.trim(),style:{borderRadius:"8px",background:l||!n.trim()?"#d9d9d9":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.4)",height:"48px",fontSize:"16px",color:l||!n.trim()?"#666666":"#ffffff"},children:f?"æ›´æ–°é…ç½®":"ä¿å­˜é…ç½®"})]}),e.jsx(A,{style:{boxShadow:"0 2px 8px rgba(0,0,0,0.1)",borderRadius:"12px"},children:e.jsxs(I,{form:t,layout:"vertical",onFinish:r,initialValues:{version:w,path:""},children:[e.jsx(I.Item,{label:"è¿­ä»£ç‰ˆæœ¬å·",name:"version",rules:[{required:!0,message:"è¯·é€‰æ‹©è¿­ä»£ç‰ˆæœ¬å·"}],children:e.jsx(L,{placeholder:"è¯·é€‰æ‹©è¿­ä»£ç‰ˆæœ¬å·",size:"large",showSearch:!0,filterOption:(s,c)=>{var v;return((v=c==null?void 0:c.children)==null?void 0:v.toString().toLowerCase().includes(s.toLowerCase()))||!1},style:{borderRadius:"8px"},children:he().map(s=>e.jsx(fe,{value:s.value,children:s.label},s.value))})}),e.jsx(I.Item,{label:"èœå•è·¯å¾„",name:"path",rules:[{required:!0,message:"è¯·è¾“å…¥èœå•è·¯å¾„"}],children:e.jsx(X,{size:"large",style:{borderRadius:"8px"}})}),e.jsxs(I.Item,{label:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"èœå•JSONé…ç½®"}),e.jsx(g,{size:"small",onClick:p,disabled:!n.trim(),style:{borderRadius:"6px"},children:"æ ¼å¼åŒ–JSON"})]}),required:!0,children:[e.jsx("div",{style:{border:"1px solid #d9d9d9",borderRadius:"8px",overflow:"hidden"},children:e.jsx(q,{height:"600px",defaultLanguage:"json",value:n,onChange:z,options:{minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,wordWrap:"on",automaticLayout:!0},theme:"light"})}),l&&e.jsxs("div",{style:{color:"#ff4d4f",marginTop:"8px",fontSize:"14px"},children:["âŒ ",l]}),!n.trim()&&e.jsx("div",{style:{color:"#ff4d4f",marginTop:"8px",fontSize:"14px"},children:"âŒ è¯·è¾“å…¥èœå•JSONé…ç½®"})]})]})})]})})},{Title:xe}=M,ge=()=>{const[t,o]=h.useState(null),[i,n]=h.useState(!1),a=V(),{id:l}=P();h.useEffect(()=>{l&&m(l)},[l]);const m=async x=>{n(!0);try{const u=await b.getById(x);u?o(u):(d.error("èœå•é…ç½®ä¸å­˜åœ¨"),a("/"))}catch{d.error("åŠ è½½èœå•é…ç½®å¤±è´¥"),a("/")}finally{n(!1)}},w=async()=>{if(t)try{await navigator.clipboard.writeText(t.jsonConfig),d.success("JSONé…ç½®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch{const u=document.createElement("textarea");u.value=t.jsonConfig,document.body.appendChild(u),u.select(),document.execCommand("copy"),document.body.removeChild(u),d.success("JSONé…ç½®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}},S=async()=>{if(!t)return;const x={version:t.version,path:t.path,jsonConfig:JSON.parse(t.jsonConfig),createdAt:t.createdAt,updatedAt:t.updatedAt};try{await navigator.clipboard.writeText(JSON.stringify(x,null,2)),d.success("å®Œæ•´é…ç½®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch{const f=document.createElement("textarea");f.value=JSON.stringify(x,null,2),document.body.appendChild(f),f.select(),document.execCommand("copy"),document.body.removeChild(f),d.success("å®Œæ•´é…ç½®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}};return i?e.jsx("div",{style:{padding:"24px",textAlign:"center"},children:"åŠ è½½ä¸­..."}):t?e.jsxs("div",{style:{padding:"24px",maxWidth:"1200px",margin:"0 auto"},children:[e.jsxs("div",{style:{marginBottom:"24px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(g,{icon:e.jsx(W,{}),onClick:()=>a("/"),style:{marginRight:"16px"},children:"è¿”å›žåˆ—è¡¨"}),e.jsx(xe,{level:2,style:{margin:0},children:"èœå•é…ç½®è¯¦æƒ…"})]}),e.jsxs(E,{children:[e.jsx(g,{icon:e.jsx($,{}),onClick:S,children:"å¤åˆ¶å…¨éƒ¨"}),e.jsx(g,{type:"primary",icon:e.jsx(Y,{}),onClick:()=>a(`/edit/${l}`),children:"ç¼–è¾‘é…ç½®"})]})]}),e.jsx(A,{style:{marginBottom:"24px"},children:e.jsxs(O,{title:"åŸºæœ¬ä¿¡æ¯",bordered:!0,column:2,children:[e.jsx(O.Item,{label:"èœå•è·¯å¾„",span:2,children:t.path}),e.jsx(O.Item,{label:"è¿­ä»£ç‰ˆæœ¬å·",children:t.version}),e.jsx(O.Item,{label:"é…ç½®ID",children:t.id}),e.jsx(O.Item,{label:"åˆ›å»ºæ—¶é—´",children:new Date(t.createdAt).toLocaleString()}),e.jsx(O.Item,{label:"æ›´æ–°æ—¶é—´",children:new Date(t.updatedAt).toLocaleString()})]})}),e.jsx(A,{title:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"JSONé…ç½®"}),e.jsx(g,{size:"small",icon:e.jsx($,{}),onClick:w,children:"å¤åˆ¶JSON"})]}),children:e.jsx("div",{style:{border:"1px solid #d9d9d9",borderRadius:"6px"},children:e.jsx(q,{height:"500px",defaultLanguage:"json",value:t.jsonConfig,options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,wordWrap:"on",automaticLayout:!0},theme:"light"})})})]}):e.jsx("div",{style:{padding:"24px",textAlign:"center"},children:"èœå•é…ç½®ä¸å­˜åœ¨"})},ye=()=>e.jsx(Z,{locale:ee,children:e.jsx(re,{basename:"/menu-home",children:e.jsx("div",{className:"app",children:e.jsxs(se,{children:[e.jsx(J,{path:"/",element:e.jsx(pe,{})}),e.jsx(J,{path:"/add",element:e.jsx(F,{})}),e.jsx(J,{path:"/edit/:id",element:e.jsx(F,{})}),e.jsx(J,{path:"/detail/:id",element:e.jsx(ge,{})})]})})})});U.createRoot(document.getElementById("root")).render(e.jsx(Q.StrictMode,{children:e.jsx(ye,{})}));
